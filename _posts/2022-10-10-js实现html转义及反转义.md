---
layout: post
title: js实现html转义及反转义
date: 2022-10-10
tags: "#nuxt, #vue"
categories: ["vue"]
---

### 场景：开发中，我们常会在输入框输入东西然后提交。然后，会把提交的东西在某个地方进行渲染。在输入框输入的时候，我们可能会输入一些 html 标签或者特殊字符，如<、>、@、""等等。这个时候，我们通常会把它们进行转义后保存，然后在获取渲染的时候，进行反转义。

例如：我们在输入框输入一段文本，

```
'121'<p>123</p>@"321"@
```

执行转义的方法：

```
function htmlEncode(html){
    const temp = document.createElement('div');
    temp.textContent !== null ? temp.textContent = html : temp.innerText = html;
    const output = temp.innerHTML;
    return output;
}
```

进行转义后，变成下面的字符串进行保存：

```
htmlEncode(`'121'<p>123</p>@"321"@`)
// 执行后输出：
'121'&lt;p&gt;123&lt;/p&gt;@"321"@
```

渲染的时候，进行反转义：
反转义方法：

```
function htmlDecode(text) {
    const temp = document.createElement('div');
    temp.innerHTML = text;
    const output = temp.innerText || temp.textContent;
    return output;
}
```

执行反转义后，变成下面的字符串：

```
htmlDecode(`'121'&lt;p&gt;123&lt;/p&gt;@"321"@`)
// 执行后输出：
'121'<p>123</p>@"321"@
```

另外，笔记：

innerHTML 指的是从对象的起始位置到终止位置的全部内容,包括 Html 标签。
innerText 指的是从起始位置到终止位置的内容,但它去除 Html 标签。

innerHTML 是所有浏览器都支持的
innerText 是 IE 浏览器和 chrome 浏览器支持的，Firefox 浏览器不支持。
Firefox 浏览器使用 textContent
其实，innerHTML 是 W3C 组织规定的属性；而 innerText 属性是 IE 浏览器自己的属性，不过后来的浏览器部分实现这个属性罢了。
