---
layout: post
title: nuxt生产环境报错:Failed to execute 'appendChild' on 'Node'
date: 2022-08-24
tags: "#nuxt, #vue"
categories: ["vue"]
---

### 问题：nuxt生产环境报错:Failed to execute 'appendChild' on 'Node'--- This node type does not support this method...

使用nuxt的时候，本地运行没问题，部署到生产环境之后，初次加载没问题，刷新页面，就报错：Failed to execute 'appendChild' on 'Node': This node type does not support this method...

类似的问题，还在另一个项目遇到过，修改地址栏，页面导航到404路由页面，也是报同样的错。开始以为是nginx配置有问题，结果对比另一个项目的配置，发现并没有任何不一样的地方。

搁置了一段时间这个问题，然后在遇到某个页面刷新报错的时候，联想到应该是同一类问题。

查阅资料，有好几种出现该问题的原因。

其中一个最能让我觉得靠谱的就是，"出错的部分是在layouts模板文件中引入的，而不是动态渲染nuxt部分，所以可以猜测应该是模板中的除了动态渲染的部分以外，其余都得用v-show所控制的css样式去让它显示隐藏，而不能用v-if，应该是模板内不支持动态生成元素方法，就如报错的appendChild"。

解决办法是，根据使用的nuxt版本，在该组件的外层加一个<client-only>或者<no-ssr>即可解决。
If you are using a version of Nuxt < v2.9.0, use <no-ssr> instead of <client-only>
<client-only>需要安装第三方组件：vue-client-only后使用。

实践证明，确实如此。